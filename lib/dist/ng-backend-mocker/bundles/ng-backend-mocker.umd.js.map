{"version":3,"file":"ng-backend-mocker.umd.js","sources":["../../../projects/ng-backend-mocker/src/lib/api-mock-http-interceptor.ts","../../../projects/ng-backend-mocker/src/lib/ng-backend-mocker.module.ts","../../../projects/ng-backend-mocker/src/lib/response-checkpoint.ts","../../../projects/ng-backend-mocker/src/public-api.ts","../../../projects/ng-backend-mocker/src/ng-backend-mocker.ts"],"sourcesContent":["import { HttpEvent, HttpHandler, HttpHeaders, HttpInterceptor, HttpRequest, HttpResponse } from \"@angular/common/http\";\nimport { Inject, Injectable } from \"@angular/core\";\nimport { Observable, Subject } from \"rxjs\";\nimport { IBackendMockDataProvider } from \"./ibackend-mockdata-provider\";\n\n\n@Injectable()\nexport class ApiMockHttpInterceptor implements HttpInterceptor {\n\n\n    constructor(\n        @Inject('IBackendMockDataProvider') private backend: IBackendMockDataProvider,\n        @Inject('env') private environment\n    ) {\n        console.log('Environment: ',environment);\n    }\n\n    intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n\n\n        if (this.noMock()) {\n\n            return next.handle(req);\n        }\n\n        const interactions = this.backend.getAllInteractions();\n\n        for (const key in interactions) {\n\n            const int = interactions[key];\n\n            if (int.accepts(req)) {\n\n                var handler = new Subject<HttpEvent<any>>();\n\n                console.info(\"Found a response interaction.\");\n\n                var response = new HttpResponse({\n                    body: int.responseBody,\n                    headers: int.responseHeaders,\n                    status: int.responseCode,\n                    url: req.url\n                });\n\n                setTimeout(() => {\n                    handler.next(response);\n                    handler.complete();\n                }, 100);\n\n                return handler;\n            }\n        }\n\n        console.log('redirected to real path');\n        \n        return next.handle(req);\n    }\n\n\n\n    private noMock(): boolean {\n\n        const envAny: any = this.environment;\n\n        if (envAny?.mockBackend) {\n\n            return false;\n        }\n        return true;\n    }\n}","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { ApiMockHttpInterceptor } from './api-mock-http-interceptor';\nimport { ResponseCheckPoint } from './response-checkpoint';\nimport { IBackendMockDataProvider } from './ibackend-mockdata-provider'\n\n\n\n@NgModule({\n  declarations: [  ],\n  imports: [\n  ],\n  exports: [\n  ],\n  providers: [\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: ApiMockHttpInterceptor,\n      multi: true\n    }\n  ]\n})\nexport class NgBackendMockerModule {\n\n  public static forRoot(environment: any): ModuleWithProviders<any> {\n\n    return {\n      ngModule: NgBackendMockerModule,\n      providers: [\n        {\n          provide: 'env',\n          useValue: environment\n        }\n      ]\n    };\n  }\n}\n","import { HttpHeaders, HttpRequest } from \"@angular/common/http\";\n\n\n\n\n\n\nexport class ResponseCheckPoint {\n\n\n    public method: string = 'GET';\n\n    public path: string = '';\n\n    public responseBody: any;\n\n    public responseCode: number = 200;\n\n    public responseHeaders: HttpHeaders = new HttpHeaders();\n\n    public requestSelector: (HttpRequest, ResponseCheckPoint) => boolean;\n\n\n    constructor() {\n\n        this.method = 'GET';\n        this.path = '';\n        this.responseBody = null;\n        this.responseCode = 200;\n        this.responseHeaders = new HttpHeaders();\n        this.requestSelector = (req: HttpRequest<any>, rcp: ResponseCheckPoint) => true;\n    }\n\n    public withMethod(method: string): ResponseCheckPoint {\n        this.method = method;\n        return this;\n    }\n\n    public withPath(path: string): ResponseCheckPoint {\n        this.path = path;\n        return this;\n    }\n\n    public withBody(body: any): ResponseCheckPoint {\n        this.responseBody = body;\n        return this;\n    }\n\n    public withCode(code: number): ResponseCheckPoint {\n        this.responseCode = code;\n        return this;\n    }\n\n    public withHeader(key: string, value: string): ResponseCheckPoint {\n\n        this.responseHeaders.append(key, value);\n        return this;\n    }\n\n    public withSelector(selector: (HttpRequest, ResponseCheckPoint) => boolean): ResponseCheckPoint {\n        this.requestSelector = selector;\n        return this;\n    }\n\n    public selectByPathOnly(): ResponseCheckPoint {\n\n        this.requestSelector = (req: HttpRequest<any>, rcp: ResponseCheckPoint) =>\n            req.url == rcp.path;\n        return this;\n    }\n\n\n    public selectByPathAndMethod(): ResponseCheckPoint {\n\n        this.requestSelector = (req: HttpRequest<any>, rcp: ResponseCheckPoint) =>\n            req.url == rcp.path && req.method.toLowerCase() == rcp.method.toLowerCase();\n        return this;\n    }\n\n    public selectAll():ResponseCheckPoint{\n\n        this.requestSelector = (req: HttpRequest<any>, rcp: ResponseCheckPoint) => true;\n        return this;\n    }\n\n    public accepts(req: HttpRequest<any>): boolean {\n\n        return this.requestSelector(req, this);\n    }\n\n}","/*\n * Public API Surface of ng-backend-mocker\n */\n\nexport * from './lib/ng-backend-mocker.module';\nexport * from './lib/ibackend-mockdata-provider'\nexport * from './lib/response-checkpoint'\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {ApiMockHttpInterceptor as Éµa} from './lib/api-mock-http-interceptor';"],"names":["Subject","HttpResponse","Injectable","Inject","NgModule","HTTP_INTERCEPTORS","HttpHeaders"],"mappings":";;;;;;;QAUI,gCACgD,OAAiC,EACtD,WAAW;YADU,YAAO,GAAP,OAAO,CAA0B;YACtD,gBAAW,GAAX,WAAW,CAAA;YAElC,OAAO,CAAC,GAAG,CAAC,eAAe,EAAC,WAAW,CAAC,CAAC;SAC5C;QAED,0CAAS,GAAT,UAAU,GAAqB,EAAE,IAAiB;YAG9C,IAAI,IAAI,CAAC,MAAM,EAAE,EAAE;gBAEf,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;aAC3B;YAED,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,kBAAkB,EAAE,CAAC;YAEvD,KAAK,IAAM,GAAG,IAAI,YAAY,EAAE;gBAE5B,IAAM,GAAG,GAAG,YAAY,CAAC,GAAG,CAAC,CAAC;gBAE9B,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;oBAElB,IAAI,OAAO,GAAG,IAAIA,YAAO,EAAkB,CAAC;oBAE5C,OAAO,CAAC,IAAI,CAAC,+BAA+B,CAAC,CAAC;oBAE9C,IAAI,QAAQ,GAAG,IAAIC,iBAAY,CAAC;wBAC5B,IAAI,EAAE,GAAG,CAAC,YAAY;wBACtB,OAAO,EAAE,GAAG,CAAC,eAAe;wBAC5B,MAAM,EAAE,GAAG,CAAC,YAAY;wBACxB,GAAG,EAAE,GAAG,CAAC,GAAG;qBACf,CAAC,CAAC;oBAEH,UAAU,CAAC;wBACP,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;wBACvB,OAAO,CAAC,QAAQ,EAAE,CAAC;qBACtB,EAAE,GAAG,CAAC,CAAC;oBAER,OAAO,OAAO,CAAC;iBAClB;aACJ;YAED,OAAO,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;YAEvC,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;SAC3B;QAIO,uCAAM,GAAN;YAEJ,IAAM,MAAM,GAAQ,IAAI,CAAC,WAAW,CAAC;YAErC,IAAI,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,WAAW,EAAE;gBAErB,OAAO,KAAK,CAAC;aAChB;YACD,OAAO,IAAI,CAAC;SACf;;;;gBA/DJC,eAAU;;;gDAKFC,WAAM,SAAC,0BAA0B;gDACjCA,WAAM,SAAC,KAAK;;;;QCUrB;;QAEgB,6BAAO,GAAd,UAAe,WAAgB;YAEpC,OAAO;gBACL,QAAQ,EAAE,qBAAqB;gBAC/B,SAAS,EAAE;oBACT;wBACE,OAAO,EAAE,KAAK;wBACd,QAAQ,EAAE,WAAW;qBACtB;iBACF;aACF,CAAC;SACH;;;;gBA3BFC,aAAQ,SAAC;oBACR,YAAY,EAAE,EAAI;oBAClB,OAAO,EAAE,EACR;oBACD,OAAO,EAAE,EACR;oBACD,SAAS,EAAE;wBACT;4BACE,OAAO,EAAEC,sBAAiB;4BAC1B,QAAQ,EAAE,sBAAsB;4BAChC,KAAK,EAAE,IAAI;yBACZ;qBACF;iBACF;;;;QCEG;YAbO,WAAM,GAAW,KAAK,CAAC;YAEvB,SAAI,GAAW,EAAE,CAAC;YAIlB,iBAAY,GAAW,GAAG,CAAC;YAE3B,oBAAe,GAAgB,IAAIC,gBAAW,EAAE,CAAC;YAOpD,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YACpB,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;YACf,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC;YACxB,IAAI,CAAC,eAAe,GAAG,IAAIA,gBAAW,EAAE,CAAC;YACzC,IAAI,CAAC,eAAe,GAAG,UAAC,GAAqB,EAAE,GAAuB,IAAK,OAAA,IAAI,GAAA,CAAC;SACnF;QAEM,uCAAU,GAAV,UAAW,MAAc;YAC5B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,OAAO,IAAI,CAAC;SACf;QAEM,qCAAQ,GAAR,UAAS,IAAY;YACxB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,OAAO,IAAI,CAAC;SACf;QAEM,qCAAQ,GAAR,UAAS,IAAS;YACrB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,OAAO,IAAI,CAAC;SACf;QAEM,qCAAQ,GAAR,UAAS,IAAY;YACxB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,OAAO,IAAI,CAAC;SACf;QAEM,uCAAU,GAAV,UAAW,GAAW,EAAE,KAAa;YAExC,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;YACxC,OAAO,IAAI,CAAC;SACf;QAEM,yCAAY,GAAZ,UAAa,QAAsD;YACtE,IAAI,CAAC,eAAe,GAAG,QAAQ,CAAC;YAChC,OAAO,IAAI,CAAC;SACf;QAEM,6CAAgB,GAAhB;YAEH,IAAI,CAAC,eAAe,GAAG,UAAC,GAAqB,EAAE,GAAuB,IAClE,OAAA,GAAG,CAAC,GAAG,IAAI,GAAG,CAAC,IAAI,GAAA,CAAC;YACxB,OAAO,IAAI,CAAC;SACf;QAGM,kDAAqB,GAArB;YAEH,IAAI,CAAC,eAAe,GAAG,UAAC,GAAqB,EAAE,GAAuB,IAClE,OAAA,GAAG,CAAC,GAAG,IAAI,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,MAAM,CAAC,WAAW,EAAE,IAAI,GAAG,CAAC,MAAM,CAAC,WAAW,EAAE,GAAA,CAAC;YAChF,OAAO,IAAI,CAAC;SACf;QAEM,sCAAS,GAAT;YAEH,IAAI,CAAC,eAAe,GAAG,UAAC,GAAqB,EAAE,GAAuB,IAAK,OAAA,IAAI,GAAA,CAAC;YAChF,OAAO,IAAI,CAAC;SACf;QAEM,oCAAO,GAAP,UAAQ,GAAqB;YAEhC,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;SAC1C;iCAEJ;KAAA;;IC1FD;;;;ICAA;;;;;;;;;;;;;;"}